(function(){"use strict";var t={8639:function(t,e,n){var i=n(9242),o=n(3396);function a(t,e,n,i,a,s){const l=(0,o.up)("TelegramSettings");return(0,o.wg)(),(0,o.j4)(l)}const s=t=>((0,o.dD)("data-v-4470e01c"),t=t(),(0,o.Cn)(),t),l=s((()=>(0,o._)("br",null,null,-1))),r=s((()=>(0,o._)("br",null,null,-1))),u=s((()=>(0,o._)("br",null,null,-1))),c=s((()=>(0,o._)("br",null,null,-1))),d=s((()=>(0,o._)("br",null,null,-1))),f={key:0,class:"requestSaved"};function p(t,e,n,i,a,s){const p=(0,o.up)("MDBCardTitle"),h=(0,o.up)("MDBInput"),m=(0,o.up)("MDBCardText"),v=(0,o.up)("MDBBtn"),g=(0,o.up)("MDBCardBody"),k=(0,o.up)("MDBCard"),w=(0,o.up)("MDBSwitch"),b=(0,o.up)("MDBAccordionItem"),D=(0,o.up)("MDBAccordion"),y=(0,o.up)("MDBContainer");return(0,o.wg)(),(0,o.iD)(o.HY,null,[l,r,(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Uk)("Connectivity settings")])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{modelValue:a.token,"onUpdate:modelValue":e[0]||(e[0]=t=>a.token=t),label:"Bot token",onChange:e[1]||(e[1]=t=>s.setUnsaved())},null,8,["modelValue"]),u,(0,o.Wm)(h,{modelValue:a.chatId,"onUpdate:modelValue":e[2]||(e[2]=t=>a.chatId=t),label:"Chat ID",onChange:e[3]||(e[3]=t=>s.setUnsaved())},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,{color:"primary",onClick:s.saveSettings},{default:(0,o.w5)((()=>[(0,o.Uk)("Save")])),_:1},8,["onClick"]),(0,o.Wm)(v,{disabled:!1===a.saved,color:"primary",onClick:s.testSettings},{default:(0,o.w5)((()=>[(0,o.Uk)("Test")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1}),c,d,(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Uk)("Notification settings")])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(D,{modelValue:i.activeItem,"onUpdate:modelValue":e[4]||(e[4]=t=>i.activeItem=t)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.sortedNotifications,((t,e)=>((0,o.wg)(),(0,o.j4)(b,{key:e,collapseId:e,headerTitle:s.getTitle(t)},{default:(0,o.w5)((()=>[(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.statuses,((t,n)=>((0,o.wg)(),(0,o.iD)("li",{key:n},[(0,o.Wm)(w,{modelValue:a.notifications[e].statuses[n],"onUpdate:modelValue":t=>a.notifications[e].statuses[n]=t,label:n,onClick:t=>s.saveNotifications(e,n)},null,8,["modelValue","onUpdate:modelValue","label","onClick"]),a.spinners[e][n]?((0,o.wg)(),(0,o.iD)("span",f,"Saved!")):(0,o.kq)("",!0)])))),128))])])),_:2},1032,["collapseId","headerTitle"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})],64)}var h=n(4313),m=n(4870),v={name:"TelegramSettings",components:{MDBCard:h.Yl,MDBCardBody:h.H7,MDBCardTitle:h.QM,MDBCardText:h.Pp,MDBBtn:h.$v,MDBContainer:h.L5,MDBInput:h.u2,MDBAccordion:h.FI,MDBAccordionItem:h.nn,MDBSwitch:h.xc},data(){return{token:"",chatId:"",notifications:{},saved:!0,spinners:[]}},setup(){const t=(0,m.iH)("collapseOne");return{activeItem:t}},computed:{sortedNotifications:function(){return Object.keys(this.notifications).sort().reduce(((t,e)=>(t[e]=this.notifications[e],t)),{})}},async created(){await fetch("/api/settings").then((t=>{this.token=t["token"],this.chatId=t["chatId"],this.notifications=t["notifications"];for(let e in this.notifications){this.spinners[e]={};for(let t in this.notifications[e]["statuses"])this.spinners[e][t]=!1}}))},methods:{setUnsaved(){this.saved=!1},saveNotifications(t,e){setTimeout((()=>{this.makeRequest(),this.spinners[t][e]=!0,setTimeout((()=>{this.spinners[t][e]=!1}),2e3)}),3e3)},saveSettings(t){t.preventDefault(),this.makeRequest()},testSettings(t){t.preventDefault();let e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"This is a test message"})};fetch("/api/test-message",e).then((t=>t.json())).then((t=>{"FAIL"===t.status?alert("request failed: "+t.error):alert("request successfully sent!")}))},makeRequest(){let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:this.token,chatId:this.chatId,notifications:this.notifications})};fetch("/api/settings",t).then((t=>t.json())).then((()=>{alert("saved"),this.saved=!0}))},getTitle(t){let e=0;for(let n in t.statuses)t.statuses[n]&&e++;return t.title+" ("+e+" of "+Object.keys(t.statuses).length+" enabled)"}}},g=n(89);const k=(0,g.Z)(v,[["render",p],["__scopeId","data-v-4470e01c"]]);var w=k,b={name:"App",components:{TelegramSettings:w}};const D=(0,g.Z)(b,[["render",a]]);var y=D;(0,i.ri)(y).mount("#app")}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}n.m=t,function(){var t=[];n.O=function(e,i,o,a){if(!i){var s=1/0;for(c=0;c<t.length;c++){i=t[c][0],o=t[c][1],a=t[c][2];for(var l=!0,r=0;r<i.length;r++)(!1&a||s>=a)&&Object.keys(n.O).every((function(t){return n.O[t](i[r])}))?i.splice(r--,1):(l=!1,a<s&&(s=a));if(l){t.splice(c--,1);var u=o();void 0!==u&&(e=u)}}return e}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[i,o,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var o,a,s=i[0],l=i[1],r=i[2],u=0;if(s.some((function(e){return 0!==t[e]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(r)var c=r(n)}for(e&&e(i);u<s.length;u++)a=s[u],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(c)},i=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(8639)}));i=n.O(i)})();
//# sourceMappingURL=app.3ed064b7.js.map