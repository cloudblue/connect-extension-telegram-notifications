(function(){"use strict";var e={981:function(e,t,n){var l=n(9242),a=n(3396);function o(e,t,n,l,o,i){const s=(0,a.up)("TelegramSettings");return(0,a.wg)(),(0,a.j4)(s)}var i=n(7139);const s=e=>((0,a.dD)("data-v-19c59fdd"),e=e(),(0,a.Cn)(),e),d=s((()=>(0,a._)("br",null,null,-1))),u=s((()=>(0,a._)("br",null,null,-1))),r=s((()=>(0,a._)("br",null,null,-1))),c=s((()=>(0,a._)("br",null,null,-1))),f=s((()=>(0,a._)("br",null,null,-1))),m={key:0,class:"requestSaved"};function p(e,t,n,l,o,s){const p=(0,a.up)("MDBCardTitle"),h=(0,a.up)("MDBInput"),M=(0,a.up)("MDBCardText"),v=(0,a.up)("MDBBtn"),B=(0,a.up)("MDBCardBody"),g=(0,a.up)("MDBCard"),w=(0,a.up)("MDBSwitch"),D=(0,a.up)("MDBAccordionItem"),k=(0,a.up)("MDBAccordion"),y=(0,a.up)("MDBModalTitle"),b=(0,a.up)("MDBModalHeader"),T=(0,a.up)("MDBModalBody"),_=(0,a.up)("MDBModalFooter"),C=(0,a.up)("MDBModal"),W=(0,a.up)("MDBContainer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[d,u,(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(B,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Connectivity settings")])),_:1}),(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,{modelValue:o.token,"onUpdate:modelValue":t[0]||(t[0]=e=>o.token=e),label:"Bot token",onChange:t[1]||(t[1]=e=>s.setUnsaved())},null,8,["modelValue"]),r,(0,a.Wm)(h,{modelValue:o.chatId,"onUpdate:modelValue":t[2]||(t[2]=e=>o.chatId=e),label:"Chat ID",onChange:t[3]||(t[3]=e=>s.setUnsaved())},null,8,["modelValue"])])),_:1}),(0,a.Wm)(v,{color:"primary",onClick:s.saveSettings},{default:(0,a.w5)((()=>[(0,a.Uk)("Save")])),_:1},8,["onClick"]),(0,a.Wm)(v,{disabled:!1===o.saved,color:"primary",onClick:s.testSettings},{default:(0,a.w5)((()=>[(0,a.Uk)("Test")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1}),c,f,(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(B,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Notification settings")])),_:1}),(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(k,{modelValue:l.activeItem,"onUpdate:modelValue":t[4]||(t[4]=e=>l.activeItem=e)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.notifications,((e,t)=>((0,a.wg)(),(0,a.j4)(D,{key:t,collapseId:t,headerTitle:s.getTitle(e)},{default:(0,a.w5)((()=>[(0,a._)("ul",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.statuses,((e,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n},[(0,a.Wm)(w,{modelValue:o.notifications[t].statuses[n],"onUpdate:modelValue":e=>o.notifications[t].statuses[n]=e,label:n,onClick:e=>s.saveNotifications(t,n)},null,8,["modelValue","onUpdate:modelValue","label","onClick"]),o.spinners[t][n]?((0,a.wg)(),(0,a.iD)("span",m,"Saved!")):(0,a.kq)("",!0)])))),128))])])),_:2},1032,["collapseId","headerTitle"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(C,{id:"exampleModal",modelValue:l.exampleModal,"onUpdate:modelValue":t[6]||(t[6]=e=>l.exampleModal=e),labelledby:"exampleModalLabel",tabindex:"-1"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,{id:"exampleModalLabel"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(o.modalTitle),1)])),_:1})])),_:1}),(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(o.modalBody),1)])),_:1}),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,{color:"secondary",onClick:t[5]||(t[5]=e=>l.exampleModal=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("Ok")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})],64)}var h=n(4313),M=n(4870),v={name:"TelegramSettings",components:{MDBCard:h.Yl,MDBCardBody:h.H7,MDBCardTitle:h.QM,MDBCardText:h.Pp,MDBBtn:h.$v,MDBContainer:h.L5,MDBInput:h.u2,MDBAccordion:h.FI,MDBAccordionItem:h.nn,MDBSwitch:h.xc,MDBModal:h.j3,MDBModalHeader:h.ol,MDBModalTitle:h.wo,MDBModalBody:h.Yz,MDBModalFooter:h.ab},data(){return{token:"",chatId:"",notifications:{},saved:!0,spinners:[],modalTitle:"Alert",modalBody:""}},setup(){const e=(0,M.iH)("collapseOne"),t=(0,M.iH)(!1);return{activeItem:e,exampleModal:t}},async created(){await fetch("/api/settings").then((e=>e.json())).then((e=>{this.token=e["token"],this.chatId=e["chatId"],this.notifications=e["notifications"];for(let t in this.notifications){this.spinners[t]={};for(let e in this.notifications[t]["statuses"])this.spinners[t][e]=!1}}))},methods:{setUnsaved(){this.saved=!1},saveNotifications(e,t){setTimeout((()=>{this.makeRequest(!0),this.spinners[e][t]=!0,setTimeout((()=>{this.spinners[e][t]=!1}),2e3)}),300)},saveSettings(e){e.preventDefault(),this.makeRequest(!1)},testSettings(e){e.preventDefault();let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"This is a test message"})};fetch("/api/test-message",t).then((e=>e.json())).then((e=>{"FAIL"===e.status?(this.modalTitle="Error!",this.modalBody="request failed: "+e.error,this.exampleModal=!0):(this.modalTitle="OK!",this.modalBody="request successfully sent!",this.exampleModal=!0)})).catch((e=>{this.modalTitle="Error!",this.modalBody="Request failed: "+e,this.exampleModal=!0}))},makeRequest(e){let t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:this.token,chatId:this.chatId,notifications:this.notifications})};fetch("/api/settings",t).then((e=>e.json())).then((()=>{e||(this.modalTitle="OK!",this.modalBody="Settings saved!",this.exampleModal=!0),this.saved=!0})).catch((e=>{this.modalTitle="Error!",this.modalBody="Request failed: "+e,this.exampleModal=!0}))},getTitle(e){let t=0;for(let n in e.statuses)e.statuses[n]&&t++;return e.title+" ("+t+" of "+Object.keys(e.statuses).length+" enabled)"}}},B=n(89);const g=(0,B.Z)(v,[["render",p],["__scopeId","data-v-19c59fdd"]]);var w=g,D={name:"App",components:{TelegramSettings:w}};const k=(0,B.Z)(D,[["render",o]]);var y=k;(0,l.ri)(y).mount("#app")}},t={};function n(l){var a=t[l];if(void 0!==a)return a.exports;var o=t[l]={exports:{}};return e[l](o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,l,a,o){if(!l){var i=1/0;for(r=0;r<e.length;r++){l=e[r][0],a=e[r][1],o=e[r][2];for(var s=!0,d=0;d<l.length;d++)(!1&o||i>=o)&&Object.keys(n.O).every((function(e){return n.O[e](l[d])}))?l.splice(d--,1):(s=!1,o<i&&(i=o));if(s){e.splice(r--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var r=e.length;r>0&&e[r-1][2]>o;r--)e[r]=e[r-1];e[r]=[l,a,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var a,o,i=l[0],s=l[1],d=l[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(d)var r=d(n)}for(t&&t(l);u<i.length;u++)o=i[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(r)},l=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[998],(function(){return n(981)}));l=n.O(l)})();
//# sourceMappingURL=app.6c4f4fae.js.map